replicaCount: 1

image:
  repository: calciumion/new-api
  tag: latest
  pullPolicy: IfNotPresent

database:
  usePostgres: true
  externalPostgresDsn: "postgresql://root:123456@postgres:5432/new-api"

service:
  type: ClusterIP
  port: 3000

persistence:
  # 在 database.usePostgres=false 或 mountLogs.enabled=true 时生效
  storageClassName: ""     # 例如: "nfs-client" / "gp2" / "local-path"
  accessModes:
    - ReadWriteOnce
  size: 20Gi
  existingClaim: ""        # 例如: "new-api-pvc"

mountLogs:
  enabled: false
  path: /app/logs

paths:
  dataSubPath: data
  logsSubPath: logs

env:
  # REDIS_CONN_STRING: "redis://redis"
  TZ: "Asia/Shanghai"
  ERROR_LOG_ENABLED: "false"
  BATCH_UPDATE_ENABLED: "true"
  STREAMING_TIMEOUT: "300"
  SESSION_SECRET: "random_string"
  # SYNC_FREQUENCY: "60"
  # GOOGLE_ANALYTICS_ID: "G-XXXXXXXXXX"
  # UMAMI_WEBSITE_ID: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
  # UMAMI_SCRIPT_URL: "https://analytics.umami.is/script.js"

extraArgs: []

resources:
 requests:
   cpu: 100m
   memory: 256Mi
 limits:
   cpu: 1
   memory: 1Gi

redis:
  enabled: true

  host: ""
  port: 6379
  scheme: redis

  image:
    repository: redis
    tag: "7.4"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 6379

  auth:
    enabled: false
    password: "" # auth.enabled=true 时必填（也可改成从 existingSecret 取）
    existingSecret:
      name: ""
      key: "password"

  persistence:
    enabled: true
    storageClassName: ""
    accessModes: ["ReadWriteOnce"]
    size: 20Gi

  resources: {}